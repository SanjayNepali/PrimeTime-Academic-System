<!-- File: Desktop/Prime/templates/projects/my_project.html -->

{% extends 'base.html' %}

{% block title %}My Project - PrimeTime{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Project Header -->
    <div class="project-header mb-4">
        <div class="d-flex justify-content-between align-items-center">
            <h2><i class='bx bx-folder'></i> My Project</h2>
            {% if project %}
                <span class="badge badge-status badge-{{ project.status }}">
                    {{ project.get_status_display }}
                </span>
            {% endif %}
        </div>
    </div>
    
    <!-- Tabs Navigation -->
    <ul class="nav nav-tabs modern-tabs mb-4">
        <li class="nav-item">
            <a class="nav-link {% if tab == 'overview' %}active{% endif %}" 
               href="?tab=overview">
                <i class='bx bx-info-circle'></i> Overview
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link {% if tab == 'resources' %}active{% endif %}" 
               href="?tab=resources">
                <i class='bx bx-book'></i> Resources
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link {% if tab == 'forum' %}active{% endif %}" 
               href="?tab=forum">
                <i class='bx bx-conversation'></i> Forum
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link {% if tab == 'progress' %}active{% endif %}" 
               href="?tab=progress">
                <i class='bx bx-chart'></i> Progress & Analytics
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link {% if tab == 'help' %}active{% endif %}" 
               href="?tab=help">
                <i class='bx bx-help-circle'></i> Help
            </a>
        </li>
    </ul>
    
    <!-- Tab Content -->
    <div class="tab-content">
        {% if tab == 'overview' %}
            {% if project %}
                <div class="card modern-card">
                    <div class="card-body">
                        <h4>{{ project.title }}</h4>
                        
                        {% if project.status == 'rejected' %}
                            <div class="alert alert-danger">
                                <i class='bx bx-x-circle'></i> <strong>Project Rejected</strong>
                                <p>{{ project.rejection_reason }}</p>
                                <a href="{% url 'projects:project_edit' project.pk %}" class="btn btn-primary">
                                    <i class='bx bx-edit'></i> Edit & Resubmit
                                </a>
                            </div>
                        {% endif %}
                        
                        <p>{{ project.description }}</p>
                        
                        <div class="technologies mb-3">
                            {% for lang in project.languages_list %}
                                <span class="badge bg-primary me-1">{{ lang }}</span>
                            {% endfor %}
                        </div>
                        
                        {% if can_edit %}
                            <a href="{% url 'projects:project_edit' project.pk %}" class="btn btn-primary">
                                <i class='bx bx-edit'></i> Edit Project
                            </a>
                        {% endif %}
                    </div>
                </div>
            {% else %}
                <div class="text-center py-5">
                    <i class='bx bx-folder-plus' style="font-size: 4rem; color: var(--text-secondary);"></i>
                    <h3 class="mt-3">No Project Yet</h3>
                    <p>Start your academic journey by creating a project proposal</p>
                    <a href="{% url 'projects:project_create' %}" class="btn btn-primary">
                        <i class='bx bx-plus'></i> Create Project Proposal
                    </a>
                </div>
            {% endif %}
        {% endif %}
        
        {% if tab == 'resources' %}
            <div class="card modern-card">
                <div class="card-header">
                    <h5><i class='bx bx-book'></i> Recommended Resources</h5>
                </div>
                <div class="card-body">
                    {% if resources %}
                        <div class="resources-grid">
                            {% for resource in resources %}
                                <div class="resource-card">
                                    <h6>{{ resource.title }}</h6>
                                    <p>{{ resource.description|truncatechars:100 }}</p>
                                    <a href="{{ resource.url }}" target="_blank" class="btn btn-sm btn-outline-primary">
                                        View Resource
                                    </a>
                                </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <p class="text-muted">No resources available yet. Complete your project details to get recommendations.</p>
                    {% endif %}
                </div>
            </div>
        {% endif %}
        
        {% if tab == 'forum' %}
            <div class="card modern-card">
                <div class="card-header d-flex justify-content-between">
                    <h5><i class='bx bx-conversation'></i> Forum Discussions</h5>
                    <button class="btn btn-primary btn-sm">
                        <i class='bx bx-plus'></i> Ask Question
                    </button>
                </div>
                <div class="card-body">
                    {% if forum_posts %}
                        {% for post in forum_posts %}
                            <div class="forum-post mb-3">
                                <h6>{{ post.title }}</h6>
                                <p class="text-muted small">
                                    by {{ post.author.display_name }} â€¢ {{ post.created_at|timesince }} ago
                                </p>
                                <p>{{ post.content|truncatechars:200 }}</p>
                                <a href="#" class="btn btn-sm btn-outline-secondary">View Discussion</a>
                            </div>
                        {% endfor %}
                    {% else %}
                        <p class="text-muted">No forum discussions yet. Be the first to ask a question!</p>
                    {% endif %}
                </div>
            </div>
        {% endif %}
        
        {% if tab == 'progress' %}
            <div class="row">
                <div class="col-md-8">
                    <div class="card modern-card">
                        <div class="card-header">
                            <h5><i class='bx bx-chart'></i> Progress Analytics</h5>
                        </div>
                        <div class="card-body">
                            <canvas id="progressChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card modern-card">
                        <div class="card-body text-center">
                            <h5>Overall Progress</h5>
                            <div class="progress-circle">
                                <span class="progress-value">{{ project.progress_percentage|default:0 }}%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        {% endif %}
        
        {% if tab == 'help' %}
            <div class="card modern-card">
                <div class="card-header">
                    <h5><i class='bx bx-help-circle'></i> Help & Support</h5>
                </div>
                <div class="card-body">
                    <div class="accordion" id="helpAccordion">
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#help1">
                                    How to submit a project proposal?
                                </button>
                            </h2>
                            <div id="help1" class="accordion-collapse collapse show" data-bs-parent="#helpAccordion">
                                <div class="accordion-body">
                                    Click on "Create Project Proposal" button and fill in all required details...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        {% endif %}
    </div>
</div>

<style>
.modern-tabs .nav-link {
    color: var(--text-secondary);
    border: none;
    padding: 12px 20px;
    font-weight: 500;
}

.modern-tabs .nav-link.active {
    color: var(--primary);
    background: white;
    border-bottom: 3px solid var(--primary);
}

.badge-status {
    padding: 6px 12px;
    font-weight: 500;
    border-radius: 20px;
}

.badge-rejected { background: var(--danger); color: white; }
.badge-approved { background: var(--success); color: white; }
.badge-pending { background: var(--warning); color: white; }
</style>
{% endblock %}